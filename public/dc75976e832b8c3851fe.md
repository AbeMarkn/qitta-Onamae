---
title: ラズパイ ピコ互換品で外部電圧をターミナル風に表示
tags:
  - RaspberryPi
  - 組込みソフトウェア
  - RaspberryPiPico
  - 組込制御
private: false
updated_at: '2023-08-13T18:00:41+09:00'
id: dc75976e832b8c3851fe
organization_url_name: null
slide: false
ignorePublish: false
---
# はじめに
ラズパイピコと同じSoC、RP2040と約1インチのLEDを搭載した「RP2040-LCD-0.96」で、電圧表示する仕掛けを作りました。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1048586/2b91c0a9-c646-a888-27be-d1a1d69ff2ff.png)


# 結果

https://youtu.be/woJGDI2UilA

入力電圧14Vから10Vの範囲において、0.1Vの誤差範囲で電圧を計測できました。

| 入力電圧 [V]  | 出力電圧 [V] | 電圧差 [V] |
|-------------:|------------:|---------:|
| 12.05 (約12) | 12.06       | +0.01     |
| 13.99 (約14) | 14.01       | +0.02     |
| 13.00 (約13) | 12.93       | -0.07     |
| 12.06 (約12) | 12.07       | +0.01     |
| 11.08 (約11) | 11.06       | -0.02     |
| 9.97  (約10) | 9.93        | -0.06     |
| 12.12 (約12) | 12.14       | +0.02     |

LCDは横20文字・8行です。
1行は、「０から9を繰り返すカウンタ、月日、時分秒、電圧」で構成されています。

# ソースコードと使用した部品

・ソースコードはこちら。
| 種類 | リンク |
|-|-|
| メインのコード | https://gist.github.com/AbeMarkn/ba4eb4fb97eec497d590080c8db07d78 |
| Waveshareのサンプルを拡張したコード | https://gist.github.com/AbeMarkn/c8f1660487594a794a2859eab017a507 |

表示は1秒ごとに更新しています。電圧入力は0.1秒ごとに取得し、10回分を平均しています。1秒に1回の電圧入力だと、結果がばらつきました。

・部品の一覧はこちら。
| 品名  | 個数 | 価格(税込) | 補足 |
|-------------|------------|---------:|---------|
| Waveshare RP2040-LCD-0.96 | 1       | 1,903円     | スイッチサイエンス, ラズパイ ピコ互換品 |
| 連結ピンソケット　２×２０（４０Ｐ）　ラズパイ用スタッキングコネクタ| 1 | 150円 | 秋月電子通商 【C-10702】　|
| 入出力２．５Ｖ～１５Ｖ　最大１．５Ａ　同期整流式昇降圧型スイッチング電源モジュールキット　ＬＴＣ３１１１使用 | 1 | 1,380円| 秋月電子通商 【K-11212】　 |
| ブレッドボード　ＥＩＣ－８０１| 1 | 370円| 秋月電子通商 【P-00315】 |
| その他 | 一式 |100円程度| 赤色LED, 抵抗・コネクタ|

# デザイン

電圧入力方法のメモです。抵抗で分圧して入力しています。1bitあたり4mV相当。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1048586/159f7d05-1298-d18b-5839-ce8b22730a34.png)

ターミナル風に表示をスクロールさせる方法のメモです。
検討しているときは8行でなく、3行でスクロールするイメージで作りました。 T1, T2, T3と行を追加していき、T4を追加したときにT1が消えています。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1048586/e9ce9f40-df5c-0348-b799-662c01b85874.png)

ブレッドボードの配線の様子です。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1048586/79bafb4d-034d-89b1-bfa2-129a05062d6e.png)


# おわりに
・今後、この電圧入力機能に無線機能を組み合わせて、離れた場所においてあるバイクの電圧をモニタする計画です。
・ラズパイ用スタッキングコネクタがすごく便利です。文字と色で機能を表現してくれるので間違え防止にすごく役立ちます。
